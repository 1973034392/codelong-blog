import{_ as t}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,a as o,o as l}from"./app-BzyIoBsd.js";const r={};function n(s,e){return l(),i("div",null,e[0]||(e[0]=[o('<h1 id="网关系统概述" tabindex="-1"><a class="header-anchor" href="#网关系统概述"><span>网关系统概述</span></a></h1><p>本系统是一个基于Netty和Springboot <strong>责任链模式</strong> 和 <strong>分布式服务治理</strong>的微服务网关，核心功能包括 <strong>负载均衡、请求鉴权、自定义请求处理、接口调用处理、结果包装、服务注册与发现、动态配置更新</strong> 等。系统通过 <strong>Redis</strong> 实现接口信息缓存、心跳状态同步，结合 <strong>JWT鉴权</strong> 与 <strong>安全组标识</strong> 完成权限校验，支持 <strong>HTTP/Dubbo</strong> 双协议封装与泛化调用。</p><p>在<code>GitHub</code>上查看<a href="https://github.com/1973034392/api-gateway-codelong" target="_blank" rel="noopener noreferrer">项目地址</a></p><hr><h2 id="网关核心模块" tabindex="-1"><a class="header-anchor" href="#网关核心模块"><span>网关核心模块</span></a></h2><ul><li><strong>功能</strong>：作为请求处理的核心入口，负责请求的完整生命周期管理。</li><li><strong>子模块</strong>： <ul><li><strong>Netty处理链</strong>：基于Netty构建的高性能请求处理链，包含以下Handler： <ul><li>AuthorizationHandler：JWT鉴权验证，结合安全组秘钥进行权限校验，使用Caffeine本地缓存提升性能</li><li>RateLimitHandler：分布式限流处理，支持全局、服务、接口、IP四级限流粒度</li><li>PreExecutorHandler：前置处理器编排，支持串行和并行执行自定义处理器</li><li>ExecutorHandler：执行器处理，根据请求类型选择HTTP或Dubbo连接并执行</li><li>PostExecutorHandler：后置处理器编排，处理响应结果</li><li>ResultHandler：结果封装处理，统一返回格式</li></ul></li><li><strong>分布式限流器</strong>：支持两种限流模式： <ul><li>DISTRIBUTED模式：纯分布式限流，使用Redis侧的令牌桶或滑动窗口算法</li><li>LOCAL_DISTRIBUTED模式：本地+分布式混合模式，批量从Redis获取令牌后在本地高性能限流</li></ul></li><li><strong>负载均衡</strong>：基于NGINX负载均衡 + 权重策略分配请求到后端服务，支持动态配置更新。</li><li><strong>动态代理与 RPC 调用</strong>：创建动态代理对象，封装 HTTP/Dubbo 请求，对连接源进行包装存储，支持泛化调用（泛型参数传递）。</li><li><strong>配置订阅</strong>：通过Redis Pub/Sub订阅配置变更消息，实现限流配置、服务实例等的实时更新。</li></ul></li></ul><h2 id="网关中心模块" tabindex="-1"><a class="header-anchor" href="#网关中心模块"><span>网关中心模块</span></a></h2><ul><li><strong>功能</strong>：管理全局配置、服务注册与发现、接口信息同步、限流配置管理。</li><li><strong>子模块</strong>： <ul><li><strong>配置管理</strong>：动态加载并刷新 Redis/Nginx 配置，支持负载均衡策略更新。NGINX配置通过SSH远程管理（配置在application.yml的nginx.config.remote中）。</li><li><strong>限流配置管理</strong>：提供限流规则的创建、更新、删除、查询功能，支持实时推送配置到所有网关节点，实现动态限流策略调整。支持两种限流模式（DISTRIBUTED和LOCAL_DISTRIBUTED）和两种限流算法（TOKEN_BUCKET和SLIDING_WINDOW）。</li><li><strong>服务注册与发现</strong>： <ul><li>服务提供者通过 SDK 注册服务信息（URL、接口名、方法名、参数类型、是否鉴权、是否HTTP、HTTP类型）。</li><li>Redis 存储服务元数据（Key格式：<code>heartbeat:server:服务名:地址</code> 和 <code>heartbeat:group:分组名:地址</code>）。</li><li>接口信息存储在Redis（Key格式：<code>URL:服务名:接口路径</code>）。</li></ul></li><li><strong>心跳与续约</strong>： <ul><li>服务启动时主动注册，后续定期发送心跳续约（间隔 15 秒，过期时间 30 秒）。</li><li>网关中心定时任务每15秒发送心跳请求（通过Redis Pub/Sub的heartBeat频道）。</li><li>Redis Key 过期自动触发服务下线（通过监听__keyevent@*__:expired事件），避免僵尸节点。</li></ul></li><li><strong>接口拉取与同步</strong>：服务提供者通过SDK上传接口信息到网关中心，网关中心同步到Redis，网关核心从Redis加载接口元数据。</li></ul></li></ul><h2 id="sdk-模块" tabindex="-1"><a class="header-anchor" href="#sdk-模块"><span>SDK 模块</span></a></h2><ul><li><strong>功能</strong>：提供服务提供者使用的 SDK，简化服务注册与调用。</li><li><strong>子模块</strong>： <ul><li><strong>服务注册 SDK（server-find-sdk）</strong>： <ul><li>自动加载配置，扫描 <code>@ApiInterface</code> 和 <code>@ApiMethod</code> 注解</li><li>解析接口元数据（URL、方法名、参数类型等）</li><li>支持 HTTP 和 Dubbo 双协议注册</li><li>自动上传接口信息到网关中心</li><li>定期发送心跳续约，维持服务在线状态</li></ul></li><li><strong>请求调用 SDK（server-send-sdk）</strong>： <ul><li>提供 <code>GatewayClient</code> 便捷调用网关接口</li><li>支持 GET、POST、PUT、DELETE 等 HTTP 方法</li><li>自动处理 JWT 鉴权和安全认证</li><li>支持请求参数和请求体的灵活传递</li><li>统一处理响应结果和异常</li></ul></li></ul></li></ul><h2 id="redis-消息订阅与事件通知" tabindex="-1"><a class="header-anchor" href="#redis-消息订阅与事件通知"><span>Redis 消息订阅与事件通知</span></a></h2><ul><li><strong>功能</strong>：实现分布式事件驱动，确保网关与服务提供者的实时通信。</li><li><strong>子模块</strong>： <ul><li><strong>消息订阅</strong>：监听 Redis 通道，接收服务上下线、配置变更等事件： <ul><li><code>service-launched</code>：服务启动/刷新本地缓存通知</li><li><code>heartBeat</code>：心跳请求通知</li><li><code>rate-limit-config-update</code>：限流配置更新通知</li><li><code>__keyevent@*__:expired</code>：Redis Key过期事件（用于服务下线检测）</li></ul></li><li><strong>事件处理</strong>： <ul><li>服务下线事件：监听Redis Key过期事件，自动标记服务离线状态，更新NGINX配置。</li><li>配置变更事件：网关核心订阅限流配置更新消息，动态更新本地限流器配置。</li><li>心跳事件：网关核心订阅心跳消息，触发服务实例状态检查。</li></ul></li><li><strong>全局唯一 ID 生成</strong>：使用Snowflake算法生成分布式唯一ID（通过UniqueIdUtil工具类）。</li></ul></li></ul><h2 id="数据库与持久化" tabindex="-1"><a class="header-anchor" href="#数据库与持久化"><span>数据库与持久化</span></a></h2><ul><li><strong>功能</strong>：存储网关核心数据，支持高可用与快速查询。</li><li><strong>子模块</strong>： <ul><li><strong>接口信息</strong>：存储接口的 URL、方法、参数、安全组等元数据。</li><li><strong>服务注册</strong>：记录服务提供者的地址、心跳时间、接口映射关系。</li><li><strong>限流配置</strong>：存储限流规则（限流类型、目标、阈值、策略等），支持动态配置和实时生效。</li><li><strong>配置管理</strong>：存储网关全局配置（如NGINX地址、负载均衡权重等等）。</li></ul></li></ul>',14)]))}const g=t(r,[["render",n]]),c=JSON.parse('{"path":"/projects/gateway/","title":"网关系统概述","lang":"zh-CN","frontmatter":{"description":"网关系统概述 本系统是一个基于Netty和Springboot 责任链模式 和 分布式服务治理的微服务网关，核心功能包括 负载均衡、请求鉴权、自定义请求处理、接口调用处理、结果包装、服务注册与发现、动态配置更新 等。系统通过 Redis 实现接口信息缓存、心跳状态同步，结合 JWT鉴权 与 安全组标识 完成权限校验，支持 HTTP/Dubbo 双协议封...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"网关系统概述\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-12-16T12:00:30.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"CodeLong\\",\\"url\\":\\"codelong.top\\"}]}"],["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/projects/gateway/"}],["meta",{"property":"og:site_name","content":"CodeLong"}],["meta",{"property":"og:title","content":"网关系统概述"}],["meta",{"property":"og:description","content":"网关系统概述 本系统是一个基于Netty和Springboot 责任链模式 和 分布式服务治理的微服务网关，核心功能包括 负载均衡、请求鉴权、自定义请求处理、接口调用处理、结果包装、服务注册与发现、动态配置更新 等。系统通过 Redis 实现接口信息缓存、心跳状态同步，结合 JWT鉴权 与 安全组标识 完成权限校验，支持 HTTP/Dubbo 双协议封..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-12-16T12:00:30.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-16T12:00:30.000Z"}]]},"git":{"createdTime":1747712503000,"updatedTime":1765886430000,"contributors":[{"name":"1973034392","username":"1973034392","email":"1973034392@qq.com","commits":5,"url":"https://github.com/1973034392"},{"name":"longhao08","username":"longhao08","email":"longhao08@meitua.com","commits":1,"url":"https://github.com/longhao08"}]},"readingTime":{"minutes":4.65,"words":1395},"filePathRelative":"projects/gateway/README.md","autoDesc":true}');export{g as comp,c as data};
